var WireService=function(e){"use strict";Symbol("x").toString();const t="@wire",n="updated",i="connected",s="disconnected",r="connect",c="disconnect",o="config";function a(e,t,n){n.mutated||(n.mutated=new Set,Promise.resolve().then(function(e,t){const n=new Set,i=t.mutated;delete t.mutated,i.forEach(i=>{const s=function(e,t){let n=e[t.head];if(!t.tail)return n;const i=t.tail;for(let e=0,t=i.length;e<t&&null!=n;e++){const t=i[e];if("object"!=typeof n||!(t in n))return;n=n[t]}return n}(e,i);if(t.values[i.reference]===s)return;t.values[i.reference]=s;const r=t.listeners[i.head];for(let e=0,t=r.length;e<t;e++)n.add(r[e])}),s=n,r=t.values,s.forEach(e=>{const{listener:t,statics:n,reactives:i}=e,s=Object.create(null);if(i){const e=Object.keys(i);for(let t=0,n=e.length;t<n;t++){const n=e[t],c=r[i[n]];s[n]=c}}const c=Object.assign({},n,s);t.call(void 0,c)});var s,r}.bind(void 0,e,n))),n.mutated.add(t)}function l(e,t,n){const i=a.bind(void 0,e,t,n),s=function(e,t,n){const i=function e(t,n,i){i=i||[];if(!t||i.indexOf(t)>-1)return null;const s=Object.getOwnPropertyDescriptor(t,n);if(s)return s;const r=Object.getPrototypeOf(t);if(!r)return null;i.push(t);return e(r,n,i)}(e,t);let s,r,c;if(null===i||void 0===i.get&&void 0===i.set){let i=e[t];s=!0,r=function(){return i},c=function(e){i=e,n()}}else{const{set:t,get:o}=i;s=i.enumerable,c=function(i){t&&t.call(e,i),n()},r=function(){return o?o.call(e):void 0}}return{set:c,get:r,enumerable:s,configurable:!0}}(e,t.head,i);Object.defineProperty(e,t.head,s)}const u="ValueChangedEvent";class d{constructor(e){this.type=u,this.value=e}}const h="LinkContextEvent";class f{constructor(e,t){this.type=h,this.uid=e,this.callback=t}}function v(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}function p(e){if(!e.includes("."))return{reference:e,head:e};const t=e.split(".");return{reference:e,head:t.shift(),tail:t}}class b{constructor(e,t,n,i,s){this._cmp=e,this._def=t,this._context=n,this._wireDef=i,this._wireTarget=s}addEventListener(e,u){switch(e){case r:this._context[t][i].push(u);break;case c:this._context[t][s].push(u);break;case o:{const e=this._wireDef.params,i=this._wireDef.static;let s;if(!e||0===(s=Object.keys(e)).length){const e=i||Object.create(null);return void u.call(void 0,e)}const r={listener:u,statics:i,reactives:e},c=this._context[t][n];s.forEach(t=>{const n=p(e[t]);let i=c.listeners[n.head];i?i.push(r):(i=[r],c.listeners[n.head]=i,l(this._cmp,n,c)),a(this._cmp,n,c)});break}default:throw new Error(`unsupported event type ${e}`)}}removeEventListener(e,a){switch(e){case r:v(this._context[t][i],a);break;case c:v(this._context[t][s],a);break;case o:{const e=this._context[t][n].listeners,i=this._wireDef.params;i&&Object.keys(i).forEach(t=>{const n=p(i[t]),s=e[n.head];s&&function(e,t){for(let n=0,i=e.length;n<i;n++)if(e[n].listener===t)return void e.splice(n,1)}(s,a)});break}default:throw new Error(`unsupported event type ${e}`)}}dispatchEvent(e){if(e instanceof d){const t=e.value;return this._wireDef.method?this._cmp[this._wireTarget](t):this._cmp[this._wireTarget]=t,!1}if(e instanceof f){const{uid:t,callback:n}=e,i=new CustomEvent(t,{bubbles:!0,composed:!0,detail(...e){n(...e)}});return this._cmp.dispatchEvent(i),!1}if("WireContextEvent"===e.type)return this._cmp.dispatchEvent(e);throw new Error(`Invalid event ${e}.`)}}const w=new Map;function g(e){for(let t=0,n=e.length;t<n;++t)e[t].call(void 0)}const m={wiring:(e,r,c,o)=>{const a=o[t]=Object.create(null);a[i]=[],a[s]=[],a[n]={listeners:{},values:{}};const l=c.wire,u=Object.keys(l);for(let t=0,n=u.length;t<n;t++){const n=u[t],i=l[n],s=w.get(i.adapter);if(s){const t=new b(e,c,o,i,n);s({dispatchEvent:t.dispatchEvent.bind(t),addEventListener:t.addEventListener.bind(t),removeEventListener:t.removeEventListener.bind(t)})}}},connected:(e,n,s,r)=>{let c;s.wire&&(c=r[t][i])&&g(c)},disconnected:(e,n,i,r)=>{let c;i.wire&&(c=r[t][s])&&g(c)}};return e.LinkContextEvent=f,e.ValueChangedEvent=d,e.register=function(e,t){w.set(e,t)},e.registerWireService=function(e){e(m)},e}({});
